<!DOCTYPE html>
<html>
<head>
    <title>ComplexProject - Code Map</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            line-height: 1.6; 
            color: #333;
            background-color: #f9f9f9;
        }
        h1 { color: #2c3e50; border-bottom: 2px solid #ecf0f1; padding-bottom: 10px; }
        h2 { color: #3498db; margin-top: 30px; }
        h3 { color: #2980b9; }
        h4 { color: #16a085; }
        h5 { color: #27ae60; margin-top: 15px; margin-bottom: 5px; }
        .container { display: flex; flex-wrap: wrap; gap: 20px; margin-top: 20px; }
        .component-list { 
            width: 300px; 
            background: #fff; 
            padding: 15px; 
            border-radius: 5px; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            max-height: 80vh;
            overflow-y: auto;
        }
        .component-details { 
            flex: 1; 
            min-width: 300px; 
            background: #fff; 
            padding: 15px; 
            border-radius: 5px; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            max-height: 80vh;
            overflow-y: auto;
        }
        .component { 
            margin-bottom: 8px; 
            cursor: pointer; 
            padding: 8px; 
            border-radius: 4px; 
            transition: all 0.2s;
        }
        .component:hover { 
            transform: translateX(5px);
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .component.active {
            background-color: #e3f2fd;
            border-left: 4px solid #2196f3;
        }
        .Form { background-color: #e3f2fd; border-left: 4px solid #2196f3; }
        .Module { background-color: #e8f5e9; border-left: 4px solid #4caf50; }
        .Class { background-color: #fff3e0; border-left: 4px solid #ff9800; }
        .UserControl { background-color: #f3e5f5; border-left: 4px solid #9c27b0; }
        .PropertyPage { background-color: #fffde7; border-left: 4px solid #ffc107; }
        .Designer { background-color: #ffebee; border-left: 4px solid #f44336; }
        table { 
            border-collapse: collapse; 
            width: 100%; 
            margin: 15px 0; 
            background-color: #fff;
        }
        th, td { border: 1px solid #e1e1e1; padding: 10px; text-align: left; }
        th { background-color: #f5f5f5; font-weight: 600; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        .dependency-graph { 
            margin-top: 40px; 
            border: 1px solid #e1e1e1; 
            padding: 20px; 
            border-radius: 5px; 
            background: #fff;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .legend { display: flex; flex-wrap: wrap; gap: 10px; margin: 15px 0; }
        .legend-item { display: flex; align-items: center; margin-right: 15px; }
        .legend-color { width: 20px; height: 20px; margin-right: 8px; border-radius: 3px; }
        .mermaid { 
            overflow: auto; 
            max-width: 100%; 
            min-height: 300px;
            position: relative;
        }
        footer { 
            margin-top: 50px; 
            text-align: center; 
            color: #7f8c8d; 
            font-size: 0.9em; 
            padding-top: 20px; 
            border-top: 1px solid #ecf0f1; 
        }
        .search-box {
            margin-bottom: 15px;
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .no-results {
            color: #999;
            font-style: italic;
            padding: 10px;
        }
        .button {
            padding: 8px 16px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .button:hover {
            background-color: #2980b9;
        }
        @media (max-width: 768px) {
            .container { flex-direction: column; }
            .component-list, .component-details { width: 100%; }
        }

        /* Styles for enhanced visualization */
        .diagram-tabs {
            display: flex;
            border-bottom: 1px solid #ccc;
            margin-bottom: 20px;
            overflow-x: auto;
        }

        .tab-button {
            padding: 10px 20px;
            background: #f5f5f5;
            border: none;
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
            cursor: pointer;
            font-weight: normal;
            white-space: nowrap;
        }

        .tab-button.active {
            background: #2196f3;
            color: white;
            font-weight: bold;
        }

        .tab-content {
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-top: none;
            border-radius: 0 0 5px 5px;
        }

        .filter-controls {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .search-control {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            min-width: 250px;
        }

        .component-select {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            min-width: 300px;
        }

        .control-button {
            padding: 8px 16px;
            background: #2196f3;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .control-button:hover {
            background: #0d8aee;
        }

        .depth-control {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .depth-control select {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        .error-message {
            padding: 15px;
            background: #ffebee;
            border: 1px solid #f44336;
            border-radius: 4px;
            color: #d32f2f;
            margin-top: 15px;
        }

        /* Improved diagram controls positioning and styling */
        .diagram-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.9);
            padding: 5px;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
            z-index: 100;
            display: flex;
            gap: 5px;
        }

        .diagram-controls button {
            padding: 5px 10px;
            border: 1px solid #ccc;
            background: white;
            border-radius: 3px;
            cursor: pointer;
        }

        .diagram-controls button:hover {
            background: #f5f5f5;
        }
    </style>
    <script>
        function showComponentDetails(index) {
            // Update active class
            const components = document.getElementsByClassName('component');
            for (let i = 0; i < components.length; i++) {
                components[i].classList.remove('active');
            }
            components[index].classList.add('active');

            // Show selected component details
            const details = document.getElementsByClassName('detail-section');
            for (let i = 0; i < details.length; i++) {
                details[i].style.display = 'none';
            }
            document.getElementById('component-' + index).style.display = 'block';
        }

        function searchComponents() {
            const searchTerm = document.getElementById('component-search').value.toLowerCase();
            const components = document.getElementsByClassName('component');
            let visibleCount = 0;

            for (let i = 0; i < components.length; i++) {
                const componentText = components[i].textContent.toLowerCase();
                if (componentText.includes(searchTerm)) {
                    components[i].style.display = '';
                    visibleCount++;
                } else {
                    components[i].style.display = 'none';
                }
            }

            // Show no results message if needed
            const noResults = document.getElementById('no-search-results');
            if (visibleCount === 0) {
                noResults.style.display = 'block';
            } else {
                noResults.style.display = 'none';
            }
        }
    </script>
</head>
<body>
    <h1>ComplexProject - Code Map</h1>
    <p>Project Path: tests\samples</p>
    <h2>Project Summary</h2>
    <table>
        <tr><th>Component Type</th><th>Count</th></tr>
        <tr><td>Forms</td><td>17</td></tr>
        <tr><td>Modules</td><td>6</td></tr>
        <tr><td>Classes</td><td>7</td></tr>
        <tr><td>User Controls</td><td>0</td></tr>
        <tr><td>Property Pages</td><td>0</td></tr>
        <tr><td>Designers</td><td>0</td></tr>
        <tr><th>Total</th><th>30</th></tr>
    </table>
    <div class='legend'>
        <div class='legend-item'><div class='legend-color Form'></div>Form</div>
        <div class='legend-item'><div class='legend-color Module'></div>Module</div>
        <div class='legend-item'><div class='legend-color Class'></div>Class</div>
        <div class='legend-item'><div class='legend-color UserControl'></div>User Control</div>
        <div class='legend-item'><div class='legend-color PropertyPage'></div>Property Page</div>
        <div class='legend-item'><div class='legend-color Designer'></div>Designer</div>
    </div>
    <h2>Project Components</h2>
    <div class='container'>
        <div class='component-list'>
            <h3>Components</h3>
            <input type='text' id='component-search' class='search-box' placeholder='Search components...' oninput='searchComponents()'>
            <div class='component Form' onclick='showComponentDetails(0)'>frmMain (Form)</div>
            <div class='component Form' onclick='showComponentDetails(1)'>frmOptions (Form)</div>
            <div class='component Form' onclick='showComponentDetails(2)'>frmAbout (Form)</div>
            <div class='component Form' onclick='showComponentDetails(3)'>frmCustomer (Form)</div>
            <div class='component Form' onclick='showComponentDetails(4)'>frmReport (Form)</div>
            <div class='component Form' onclick='showComponentDetails(5)'>frmLogin (Form)</div>
            <div class='component Form' onclick='showComponentDetails(6)'>frmSplash (Form)</div>
            <div class='component Form' onclick='showComponentDetails(7)'>frmProgress (Form)</div>
            <div class='component Module' onclick='showComponentDetails(8)'>modUtility (Module)</div>
            <div class='component Module' onclick='showComponentDetails(9)'>modDatabase (Module)</div>
            <div class='component Module' onclick='showComponentDetails(10)'>modGlobal (Module)</div>
            <div class='component Module' onclick='showComponentDetails(11)'>modErrorHandler (Module)</div>
            <div class='component Module' onclick='showComponentDetails(12)'>modRegistry (Module)</div>
            <div class='component Class' onclick='showComponentDetails(13)'>clsDatabase (Class)</div>
            <div class='component Class' onclick='showComponentDetails(14)'>clsCustomer (Class)</div>
            <div class='component Class' onclick='showComponentDetails(15)'>clsProduct (Class)</div>
            <div class='component Class' onclick='showComponentDetails(16)'>clsOrder (Class)</div>
            <div class='component Class' onclick='showComponentDetails(17)'>clsExport (Class)</div>
            <div class='component Class' onclick='showComponentDetails(18)'>clsImport (Class)</div>
            <div class='component Class' onclick='showComponentDetails(19)'>clsReportEngine (Class)</div>
            <div class='component Form' onclick='showComponentDetails(20)'>frmProducts (Form)</div>
            <div class='component Form' onclick='showComponentDetails(21)'>frmOrders (Form)</div>
            <div class='component Form' onclick='showComponentDetails(22)'>frmSearch (Form)</div>
            <div class='component Form' onclick='showComponentDetails(23)'>frmExport (Form)</div>
            <div class='component Form' onclick='showComponentDetails(24)'>frmImport (Form)</div>
            <div class='component Form' onclick='showComponentDetails(25)'>frmEmail (Form)</div>
            <div class='component Module' onclick='showComponentDetails(26)'>modSecurity (Module)</div>
            <div class='component Form' onclick='showComponentDetails(27)'>frmUserAdmin (Form)</div>
            <div class='component Form' onclick='showComponentDetails(28)'>frmChangePassword (Form)</div>
            <div class='component Form' onclick='showComponentDetails(29)'>frmBackup (Form)</div>
            <div id='no-search-results' class='no-results' style='display: none;'>No components found</div>
        </div>
        <div class='component-details'>
            <h3>Component Details</h3>
            <div id='component-0' class='detail-section' >
                <h4>frmMain</h4>
                <table>
                    <tr><td>Type:</td><td>Form</td></tr>
                    <tr><td>File:</td><td>frmMain.frm</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-1' class='detail-section' style='display:none;'>
                <h4>frmOptions</h4>
                <table>
                    <tr><td>Type:</td><td>Form</td></tr>
                    <tr><td>File:</td><td>frmOptions.frm</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-2' class='detail-section' style='display:none;'>
                <h4>frmAbout</h4>
                <table>
                    <tr><td>Type:</td><td>Form</td></tr>
                    <tr><td>File:</td><td>frmAbout.frm</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-3' class='detail-section' style='display:none;'>
                <h4>frmCustomer</h4>
                <table>
                    <tr><td>Type:</td><td>Form</td></tr>
                    <tr><td>File:</td><td>frmCustomer.frm</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-4' class='detail-section' style='display:none;'>
                <h4>frmReport</h4>
                <table>
                    <tr><td>Type:</td><td>Form</td></tr>
                    <tr><td>File:</td><td>frmReport.frm</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-5' class='detail-section' style='display:none;'>
                <h4>frmLogin</h4>
                <table>
                    <tr><td>Type:</td><td>Form</td></tr>
                    <tr><td>File:</td><td>frmLogin.frm</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-6' class='detail-section' style='display:none;'>
                <h4>frmSplash</h4>
                <table>
                    <tr><td>Type:</td><td>Form</td></tr>
                    <tr><td>File:</td><td>frmSplash.frm</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-7' class='detail-section' style='display:none;'>
                <h4>frmProgress</h4>
                <table>
                    <tr><td>Type:</td><td>Form</td></tr>
                    <tr><td>File:</td><td>frmProgress.frm</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-8' class='detail-section' style='display:none;'>
                <h4>modUtility</h4>
                <table>
                    <tr><td>Type:</td><td>Module</td></tr>
                    <tr><td>File:</td><td>modUtility</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-9' class='detail-section' style='display:none;'>
                <h4>modDatabase</h4>
                <table>
                    <tr><td>Type:</td><td>Module</td></tr>
                    <tr><td>File:</td><td>modDatabase</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-10' class='detail-section' style='display:none;'>
                <h4>modGlobal</h4>
                <table>
                    <tr><td>Type:</td><td>Module</td></tr>
                    <tr><td>File:</td><td>modGlobal</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-11' class='detail-section' style='display:none;'>
                <h4>modErrorHandler</h4>
                <table>
                    <tr><td>Type:</td><td>Module</td></tr>
                    <tr><td>File:</td><td>modErrorHandler</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-12' class='detail-section' style='display:none;'>
                <h4>modRegistry</h4>
                <table>
                    <tr><td>Type:</td><td>Module</td></tr>
                    <tr><td>File:</td><td>modRegistry</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-13' class='detail-section' style='display:none;'>
                <h4>clsDatabase</h4>
                <table>
                    <tr><td>Type:</td><td>Class</td></tr>
                    <tr><td>File:</td><td>clsDatabase</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-14' class='detail-section' style='display:none;'>
                <h4>clsCustomer</h4>
                <table>
                    <tr><td>Type:</td><td>Class</td></tr>
                    <tr><td>File:</td><td>clsCustomer</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-15' class='detail-section' style='display:none;'>
                <h4>clsProduct</h4>
                <table>
                    <tr><td>Type:</td><td>Class</td></tr>
                    <tr><td>File:</td><td>clsProduct</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-16' class='detail-section' style='display:none;'>
                <h4>clsOrder</h4>
                <table>
                    <tr><td>Type:</td><td>Class</td></tr>
                    <tr><td>File:</td><td>clsOrder</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-17' class='detail-section' style='display:none;'>
                <h4>clsExport</h4>
                <table>
                    <tr><td>Type:</td><td>Class</td></tr>
                    <tr><td>File:</td><td>clsExport</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-18' class='detail-section' style='display:none;'>
                <h4>clsImport</h4>
                <table>
                    <tr><td>Type:</td><td>Class</td></tr>
                    <tr><td>File:</td><td>clsImport</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-19' class='detail-section' style='display:none;'>
                <h4>clsReportEngine</h4>
                <table>
                    <tr><td>Type:</td><td>Class</td></tr>
                    <tr><td>File:</td><td>clsReportEngine</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-20' class='detail-section' style='display:none;'>
                <h4>frmProducts</h4>
                <table>
                    <tr><td>Type:</td><td>Form</td></tr>
                    <tr><td>File:</td><td>frmProducts.frm</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-21' class='detail-section' style='display:none;'>
                <h4>frmOrders</h4>
                <table>
                    <tr><td>Type:</td><td>Form</td></tr>
                    <tr><td>File:</td><td>frmOrders.frm</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-22' class='detail-section' style='display:none;'>
                <h4>frmSearch</h4>
                <table>
                    <tr><td>Type:</td><td>Form</td></tr>
                    <tr><td>File:</td><td>frmSearch.frm</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-23' class='detail-section' style='display:none;'>
                <h4>frmExport</h4>
                <table>
                    <tr><td>Type:</td><td>Form</td></tr>
                    <tr><td>File:</td><td>frmExport.frm</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-24' class='detail-section' style='display:none;'>
                <h4>frmImport</h4>
                <table>
                    <tr><td>Type:</td><td>Form</td></tr>
                    <tr><td>File:</td><td>frmImport.frm</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-25' class='detail-section' style='display:none;'>
                <h4>frmEmail</h4>
                <table>
                    <tr><td>Type:</td><td>Form</td></tr>
                    <tr><td>File:</td><td>frmEmail.frm</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-26' class='detail-section' style='display:none;'>
                <h4>modSecurity</h4>
                <table>
                    <tr><td>Type:</td><td>Module</td></tr>
                    <tr><td>File:</td><td>modSecurity</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-27' class='detail-section' style='display:none;'>
                <h4>frmUserAdmin</h4>
                <table>
                    <tr><td>Type:</td><td>Form</td></tr>
                    <tr><td>File:</td><td>frmUserAdmin.frm</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-28' class='detail-section' style='display:none;'>
                <h4>frmChangePassword</h4>
                <table>
                    <tr><td>Type:</td><td>Form</td></tr>
                    <tr><td>File:</td><td>frmChangePassword.frm</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
            <div id='component-29' class='detail-section' style='display:none;'>
                <h4>frmBackup</h4>
                <table>
                    <tr><td>Type:</td><td>Form</td></tr>
                    <tr><td>File:</td><td>frmBackup.frm</td></tr>
                </table>
                <h5>Dependencies:</h5>
                <p>No dependencies found</p>
                <h5>Referenced by:</h5>
                <p>Not referenced by any component</p>
            </div>
        </div>
    </div>
    <div class='dependency-graph'>
        <h2>Dependency Table</h2>
        <input type='text' id='table-search' class='search-box' placeholder='Search dependency table...' oninput='searchTable()'>
        <table id='dependency-table'>
            <tr><th>Component</th><th>Type</th><th>Dependencies</th><th>Referenced By</th></tr>
            <tr>
                <td>clsCustomer</td>
                <td>Class</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>clsDatabase</td>
                <td>Class</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>clsExport</td>
                <td>Class</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>clsImport</td>
                <td>Class</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>clsOrder</td>
                <td>Class</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>clsProduct</td>
                <td>Class</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>clsReportEngine</td>
                <td>Class</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>frmAbout</td>
                <td>Form</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>frmBackup</td>
                <td>Form</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>frmChangePassword</td>
                <td>Form</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>frmCustomer</td>
                <td>Form</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>frmEmail</td>
                <td>Form</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>frmExport</td>
                <td>Form</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>frmImport</td>
                <td>Form</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>frmLogin</td>
                <td>Form</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>frmMain</td>
                <td>Form</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>frmOptions</td>
                <td>Form</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>frmOrders</td>
                <td>Form</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>frmProducts</td>
                <td>Form</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>frmProgress</td>
                <td>Form</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>frmReport</td>
                <td>Form</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>frmSearch</td>
                <td>Form</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>frmSplash</td>
                <td>Form</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>frmUserAdmin</td>
                <td>Form</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>modDatabase</td>
                <td>Module</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>modErrorHandler</td>
                <td>Module</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>modGlobal</td>
                <td>Module</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>modRegistry</td>
                <td>Module</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>modSecurity</td>
                <td>Module</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
            <tr>
                <td>modUtility</td>
                <td>Module</td>
                <td>
None</td>
                <td>
None</td>
            </tr>
        </table>
    </div>

    <script>
        function searchTable() {
            const searchTerm = document.getElementById('table-search').value.toLowerCase();
            const table = document.getElementById('dependency-table');
            const rows = table.getElementsByTagName('tr');

            // Skip header row
            for (let i = 1; i < rows.length; i++) {
                const rowText = rows[i].textContent.toLowerCase();
                if (rowText.includes(searchTerm)) {
                    rows[i].style.display = '';
                } else {
                    rows[i].style.display = 'none';
                }
            }
        }
    </script>
    
    <div class='dependency-graph'>
        <h2>Visual Dependency Diagrams</h2>
        <p>Select different views to explore the project architecture:</p>

        <div class="diagram-tabs">
            <button class="tab-button active" onclick="switchTab('core-architecture')">Core Architecture</button>
            <button class="tab-button" onclick="switchTab('form-relationships')">Form Relationships</button>
            <button class="tab-button" onclick="switchTab('business-logic')">Business Logic</button>
            <button class="tab-button" onclick="switchTab('focus-mode')">Focus Mode</button>
        </div>

        <div class="tab-content" id="core-architecture" style="display: block;">
            <h3>Core Architecture View</h3>
            <p>This diagram shows the 20 most connected components in the project.</p>
            <div class="filter-controls">
                <button id="core-expand-all" class="control-button">Expand All</button>
                <button id="core-collapse-all" class="control-button">Collapse All</button>
            </div>
            <div id="core-diagram" class="mermaid">
    graph LR
    core0["frmMain"]:::form
    core1["frmOptions"]:::form
    core2["frmAbout"]:::form
    core3["frmCustomer"]:::form
    core4["frmReport"]:::form
    core5["frmLogin"]:::form
    core6["frmSplash"]:::form
    core7["frmProgress"]:::form
    core8["modUtility"]:::module
    core9["modDatabase"]:::module
    core10["modGlobal"]:::module
    core11["modErrorHandler"]:::module
    core12["modRegistry"]:::module
    core13["clsDatabase"]:::cls
    core14["clsCustomer"]:::cls
    core15["clsProduct"]:::cls
    core16["clsOrder"]:::cls
    core17["clsExport"]:::cls
    core18["clsImport"]:::cls
    core19["clsReportEngine"]:::cls

    classDef form fill:#e3f2fd,stroke:#2196f3,stroke-width:2px,color:#0d47a1
    classDef module fill:#e8f5e9,stroke:#4caf50,stroke-width:2px,color:#1b5e20
    classDef cls fill:#fff3e0,stroke:#ff9800,stroke-width:2px,color:#e65100
    classDef usercontrol fill:#f3e5f5,stroke:#9c27b0,stroke-width:2px,color:#4a148c
    classDef propertypage fill:#fffde7,stroke:#ffc107,stroke-width:2px,color:#ff6f00
    classDef designer fill:#ffebee,stroke:#f44336,stroke-width:2px,color:#b71c1c
    </div>
        </div>

        <div class="tab-content" id="form-relationships" style="display: none;">
            <h3>Form Relationships View</h3>
            <p>This diagram shows only the relationships between forms.</p>
            <div class="filter-controls">
                <input type="text" id="form-search" placeholder="Search forms..." class="search-control">
                <button id="form-apply-search" class="control-button">Filter</button>
            </div>
            <div id="form-diagram" class="mermaid">
    graph LR
    form0["frmMain"]
    form1["frmOptions"]
    form2["frmAbout"]
    form3["frmCustomer"]
    form4["frmReport"]
    form5["frmLogin"]
    form6["frmSplash"]
    form7["frmProgress"]
    form8["frmProducts"]
    form9["frmOrders"]
    form10["frmSearch"]
    form11["frmExport"]
    form12["frmImport"]
    form13["frmEmail"]
    form14["frmUserAdmin"]
    form15["frmChangePassword"]
    form16["frmBackup"]

    classDef default fill:#e3f2fd,stroke:#2196f3,stroke-width:2px,color:#0d47a1
    </div>
        </div>

        <div class="tab-content" id="business-logic" style="display: none;">
            <h3>Business Logic View</h3>
            <p>This diagram shows classes and their key dependencies.</p>
            <div id="business-diagram" class="mermaid">
    graph LR
    class0["clsDatabase"]
    class1["clsCustomer"]
    class2["clsProduct"]
    class3["clsOrder"]
    class4["clsExport"]
    class5["clsImport"]
    class6["clsReportEngine"]

    classDef cls fill:#fff3e0,stroke:#ff9800,stroke-width:2px,color:#e65100
    classDef form fill:#e3f2fd,stroke:#2196f3,stroke-width:2px,color:#0d47a1
    classDef module fill:#e8f5e9,stroke:#4caf50,stroke-width:2px,color:#1b5e20
    classDef usercontrol fill:#f3e5f5,stroke:#9c27b0,stroke-width:2px,color:#4a148c
    classDef propertypage fill:#fffde7,stroke:#ffc107,stroke-width:2px,color:#ff6f00
    classDef designer fill:#ffebee,stroke:#f44336,stroke-width:2px,color:#b71c1c
    </div>
        </div>

        <div class="tab-content" id="focus-mode" style="display: none;">
            <h3>Focus Mode</h3>
            <p>Explore the direct dependencies of a selected component.</p>
            <div class="filter-controls" style="margin-bottom: 15px;">
                <select id="focus-component" class="component-select" style="padding: 8px; min-width: 250px; margin-right: 10px;">
                    <option value="">Select a component...</option>
                        <option value="clsCustomer">clsCustomer (Class)</option>
                    <option value="clsDatabase">clsDatabase (Class)</option>
                    <option value="clsExport">clsExport (Class)</option>
                    <option value="clsImport">clsImport (Class)</option>
                    <option value="clsOrder">clsOrder (Class)</option>
                    <option value="clsProduct">clsProduct (Class)</option>
                    <option value="clsReportEngine">clsReportEngine (Class)</option>
                    <option value="frmAbout">frmAbout (Form)</option>
                    <option value="frmBackup">frmBackup (Form)</option>
                    <option value="frmChangePassword">frmChangePassword (Form)</option>
                    <option value="frmCustomer">frmCustomer (Form)</option>
                    <option value="frmEmail">frmEmail (Form)</option>
                    <option value="frmExport">frmExport (Form)</option>
                    <option value="frmImport">frmImport (Form)</option>
                    <option value="frmLogin">frmLogin (Form)</option>
                    <option value="frmMain">frmMain (Form)</option>
                    <option value="frmOptions">frmOptions (Form)</option>
                    <option value="frmOrders">frmOrders (Form)</option>
                    <option value="frmProducts">frmProducts (Form)</option>
                    <option value="frmProgress">frmProgress (Form)</option>
                    <option value="frmReport">frmReport (Form)</option>
                    <option value="frmSearch">frmSearch (Form)</option>
                    <option value="frmSplash">frmSplash (Form)</option>
                    <option value="frmUserAdmin">frmUserAdmin (Form)</option>
                    <option value="modDatabase">modDatabase (Module)</option>
                    <option value="modErrorHandler">modErrorHandler (Module)</option>
                    <option value="modGlobal">modGlobal (Module)</option>
                    <option value="modRegistry">modRegistry (Module)</option>
                    <option value="modSecurity">modSecurity (Module)</option>
                    <option value="modUtility">modUtility (Module)</option>

                </select>
                <label class="depth-control" style="margin-right: 10px;">
                    <span>Depth:</span>
                    <select id="focus-depth">
                        <option value="1">1 level</option>
                        <option value="2" selected>2 levels</option>
                        <option value="3">3 levels</option>
                    </select>
                </label>
                <button id="focus-generate" class="control-button" style="padding: 8px 16px; background: #2196f3; color: white; border: none; border-radius: 4px; cursor: pointer;">
                    Generate
                </button>
            </div>

            <!-- Simple container for the dynamically generated HTML tables -->
            <div id="focus-diagram">
                <div style="padding: 20px; text-align: center; background-color: #f5f5f5; border-radius: 4px;">
                    Select a component and click Generate to view its dependencies
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Store project data for use in dynamic diagrams
        const projectData = {"components": {"frmMain": {"type": "Form", "dependencies": [], "dependents": []}, "frmOptions": {"type": "Form", "dependencies": [], "dependents": []}, "frmAbout": {"type": "Form", "dependencies": [], "dependents": []}, "frmCustomer": {"type": "Form", "dependencies": [], "dependents": []}, "frmReport": {"type": "Form", "dependencies": [], "dependents": []}, "frmLogin": {"type": "Form", "dependencies": [], "dependents": []}, "frmSplash": {"type": "Form", "dependencies": [], "dependents": []}, "frmProgress": {"type": "Form", "dependencies": [], "dependents": []}, "modUtility": {"type": "Module", "dependencies": [], "dependents": []}, "modDatabase": {"type": "Module", "dependencies": [], "dependents": []}, "modGlobal": {"type": "Module", "dependencies": [], "dependents": []}, "modErrorHandler": {"type": "Module", "dependencies": [], "dependents": []}, "modRegistry": {"type": "Module", "dependencies": [], "dependents": []}, "clsDatabase": {"type": "Class", "dependencies": [], "dependents": []}, "clsCustomer": {"type": "Class", "dependencies": [], "dependents": []}, "clsProduct": {"type": "Class", "dependencies": [], "dependents": []}, "clsOrder": {"type": "Class", "dependencies": [], "dependents": []}, "clsExport": {"type": "Class", "dependencies": [], "dependents": []}, "clsImport": {"type": "Class", "dependencies": [], "dependents": []}, "clsReportEngine": {"type": "Class", "dependencies": [], "dependents": []}, "frmProducts": {"type": "Form", "dependencies": [], "dependents": []}, "frmOrders": {"type": "Form", "dependencies": [], "dependents": []}, "frmSearch": {"type": "Form", "dependencies": [], "dependents": []}, "frmExport": {"type": "Form", "dependencies": [], "dependents": []}, "frmImport": {"type": "Form", "dependencies": [], "dependents": []}, "frmEmail": {"type": "Form", "dependencies": [], "dependents": []}, "modSecurity": {"type": "Module", "dependencies": [], "dependents": []}, "frmUserAdmin": {"type": "Form", "dependencies": [], "dependents": []}, "frmChangePassword": {"type": "Form", "dependencies": [], "dependents": []}, "frmBackup": {"type": "Form", "dependencies": [], "dependents": []}}};

        // Tab switching functionality
        function switchTab(tabId) {
            // Hide all tab contents
            const tabContents = document.getElementsByClassName('tab-content');
            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].style.display = 'none';
            }

            // Deactivate all tab buttons
            const tabButtons = document.getElementsByClassName('tab-button');
            for (let i = 0; i < tabButtons.length; i++) {
                tabButtons[i].classList.remove('active');
            }

            // Show selected tab content and activate button
            document.getElementById(tabId).style.display = 'block';

            // Find and activate the clicked button
            for (let i = 0; i < tabButtons.length; i++) {
                if (tabButtons[i].getAttribute('onclick').includes(tabId)) {
                    tabButtons[i].classList.add('active');
                }
            }
        }

        // Wait for page load
        window.addEventListener('load', function() {
            // Initialize Focus Mode
            document.getElementById('focus-generate').addEventListener('click', function() {
                generateFocusDiagram();
            });

            // Form search functionality
            document.getElementById('form-apply-search').addEventListener('click', function() {
                const searchTerm = document.getElementById('form-search').value.toLowerCase();
                filterFormDiagram(searchTerm);
            });

            // Core diagram expand/collapse
            document.getElementById('core-expand-all').addEventListener('click', function() {
                expandAllNodes('core-diagram');
            });

            document.getElementById('core-collapse-all').addEventListener('click', function() {
                collapseAllNodes('core-diagram');
            });
        });

        // Function to escape HTML for safe insertion
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Modified function that uses dynamic tables instead of Mermaid diagrams
        function generateFocusDiagram() {
            const componentName = document.getElementById('focus-component').value;
            const depth = parseInt(document.getElementById('focus-depth').value);
            const diagramElement = document.getElementById('focus-diagram');

            // Show loading message
            diagramElement.innerHTML = '<div style="padding: 20px; text-align: center;">Generating diagram...</div>';

            if (!componentName) {
                diagramElement.innerHTML = '<div class="error-message">Please select a component first</div>';
                return;
            }

            // Create a simple HTML table showing dependencies instead of trying to render with Mermaid
            let tableHTML = `<h4>Direct Dependencies for: ${escapeHtml(componentName)}</h4>`;

            // Get component information
            const component = projectData.components[componentName];
            if (!component) {
                diagramElement.innerHTML = '<div class="error-message">Component data not found</div>';
                return;
            }

            // Add dependencies table
            if (component.dependencies && component.dependencies.length > 0) {
                tableHTML += `<h5>Dependencies (${component.dependencies.length}):</h5>`;
                tableHTML += '<table class="dependency-table" style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">';
                tableHTML += '<tr><th style="text-align: left; padding: 8px; border: 1px solid #ddd; background-color: #f5f5f5;">Component</th><th style="text-align: left; padding: 8px; border: 1px solid #ddd; background-color: #f5f5f5;">Type</th></tr>';

                component.dependencies.forEach(dep => {
                    const depComponent = projectData.components[dep];
                    const type = depComponent ? depComponent.type : "Unknown";
                    const typeClass = type.toLowerCase() === "class" ? "cls" : type.toLowerCase();

                    tableHTML += `<tr>`;
                    tableHTML += `<td style="padding: 8px; border: 1px solid #ddd;"><span class="component ${typeClass}" style="padding: 2px 5px; border-radius: 3px;">${escapeHtml(dep)}</span></td>`;
                    tableHTML += `<td style="padding: 8px; border: 1px solid #ddd;">${escapeHtml(type)}</td>`;
                    tableHTML += `</tr>`;
                });

                tableHTML += '</table>';
            } else {
                tableHTML += '<p>This component has no dependencies.</p>';
            }

            // Add dependents table
            if (component.dependents && component.dependents.length > 0) {
                tableHTML += `<h5>Referenced By (${component.dependents.length}):</h5>`;
                tableHTML += '<table class="dependency-table" style="width: 100%; border-collapse: collapse;">';
                tableHTML += '<tr><th style="text-align: left; padding: 8px; border: 1px solid #ddd; background-color: #f5f5f5;">Component</th><th style="text-align: left; padding: 8px; border: 1px solid #ddd; background-color: #f5f5f5;">Type</th></tr>';

                component.dependents.forEach(dep => {
                    const depComponent = projectData.components[dep];
                    const type = depComponent ? depComponent.type : "Unknown";
                    const typeClass = type.toLowerCase() === "class" ? "cls" : type.toLowerCase();

                    tableHTML += `<tr>`;
                    tableHTML += `<td style="padding: 8px; border: 1px solid #ddd;"><span class="component ${typeClass}" style="padding: 2px 5px; border-radius: 3px;">${escapeHtml(dep)}</span></td>`;
                    tableHTML += `<td style="padding: 8px; border: 1px solid #ddd;">${escapeHtml(type)}</td>`;
                    tableHTML += `</tr>`;
                });

                tableHTML += '</table>';
            } else {
                tableHTML += '<p>This component is not referenced by any other component.</p>';
            }

            // Set the HTML content
            diagramElement.innerHTML = tableHTML;

            // Display a message about Mermaid diagrams
            const infoMessage = document.createElement('div');
            infoMessage.style.marginTop = '20px';
            infoMessage.style.padding = '10px';
            infoMessage.style.backgroundColor = '#f8f9fa';
            infoMessage.style.border = '1px solid #ddd';
            infoMessage.style.borderRadius = '4px';
            infoMessage.innerHTML = '<p><strong>Note:</strong> Mermaid diagram generation is currently under maintenance. We are showing tabular dependency information instead.</p>';
            diagramElement.appendChild(infoMessage);
        }

        // Filter form diagram based on search term
        function filterFormDiagram(searchTerm) {
            // Implementation would filter and redraw the form diagram
            console.log("Filtering forms by:", searchTerm);
            // For now, just show a message - actual implementation would redraw the diagram
            alert("Form filtering is being implemented. Search term: " + searchTerm);
        }

        // Expand all nodes in a diagram
        function expandAllNodes(diagramId) {
            // Implementation would expand all collapsible nodes
            console.log("Expanding all nodes in", diagramId);
            // For now, just show a message - actual implementation would interact with Mermaid API
            alert("Node expansion is being implemented for " + diagramId);
        }

        // Collapse all nodes in a diagram
        function collapseAllNodes(diagramId) {
            // Implementation would collapse all expanded nodes
            console.log("Collapsing all nodes in", diagramId);
            // For now, just show a message - actual implementation would interact with Mermaid API
            alert("Node collapsing is being implemented for " + diagramId);
        }
    </script>
    
    <!-- Mermaid initialization with robust error handling -->
    <script type="module">
        // Load Mermaid with fallback options
        async function loadMermaid() {
            try {
                // First attempt - primary CDN
                return await import('https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.esm.min.mjs');
            } catch (e) {
                console.warn("Primary CDN failed, trying fallback", e);
                try {
                    // Fallback CDN
                    return await import('https://unpkg.com/mermaid@10.6.1/dist/mermaid.esm.min.mjs');
                } catch (e2) {
                    console.error("All Mermaid CDNs failed", e2);
                    throw new Error("Failed to load Mermaid");
                }
            }
        }

        window.addEventListener('load', async function() {
            try {
                // Load Mermaid
                const mermaidModule = await loadMermaid();
                window.mermaid = mermaidModule.default;

                // Configure for better performance with large diagrams
                window.mermaid.initialize({
                    startOnLoad: false,
                    securityLevel: 'loose',
                    theme: 'default',
                    logLevel: 'error',
                    flowchart: {
                        useMaxWidth: true,
                        htmlLabels: true,
                        curve: 'basis',
                        diagramPadding: 8,
                        nodeSpacing: 60,
                        rankSpacing: 100
                    },
                    fontFamily: 'Arial, sans-serif',
                    fontSize: 12
                });

                // Initially render all visible diagrams with timeout protection
                const diagrams = document.querySelectorAll('.tab-content:not([style*="display: none"]) .mermaid');
                for (const diagram of diagrams) {
                    try {
                        await renderWithTimeout(diagram);
                    } catch (error) {
                        console.error("Error rendering diagram:", error);
                        showRenderError(diagram, error.message);
                    }
                }

                // Add rendering for tab changes
                const tabButtons = document.querySelectorAll('.tab-button');
                for (const button of tabButtons) {
                    button.addEventListener('click', async function() {
                        const tabId = this.getAttribute('onclick').match(/'([^']+)'/)[1];
                        const tabContent = document.getElementById(tabId);
                        const diagrams = tabContent.querySelectorAll('.mermaid');

                        for (const diagram of diagrams) {
                            // Only render if not already rendered
                            if (!diagram.querySelector('svg')) {
                                try {
                                    await renderWithTimeout(diagram);
                                } catch (error) {
                                    console.error("Error rendering diagram on tab change:", error);
                                    showRenderError(diagram, error.message);
                                }
                            }
                        }
                    });
                }
            } catch (error) {
                console.error("Failed to initialize Mermaid:", error);
                document.querySelectorAll('.mermaid').forEach(diagram => {
                    showRenderError(diagram, "Failed to load the diagram library. This might be due to network issues.");
                });
            }
        });

        // Render diagram with timeout protection
        async function renderWithTimeout(element) {
            return new Promise((resolve, reject) => {
                const timeoutId = setTimeout(() => {
                    reject(new Error("Diagram rendering timed out - diagram may be too complex"));
                }, 10000); // 10 second timeout

                try {
                    const id = 'mermaid-' + Math.random().toString(36).substr(2, 9);
                    window.mermaid.mermaidAPI.render(id, element.textContent)
                        .then(result => {
                            clearTimeout(timeoutId);
                            element.innerHTML = result.svg;

                            // Add zoom and pan controls to SVG
                            addDiagramControls(element);

                            resolve();
                        })
                        .catch(err => {
                            clearTimeout(timeoutId);
                            reject(err);
                        });
                } catch (error) {
                    clearTimeout(timeoutId);
                    reject(error);
                }
            });
        }

        // Show error message when rendering fails
        function showRenderError(element, message) {
            element.innerHTML = 
                '<div style="padding: 20px; background-color: #ffebee; border: 1px solid #f44336; border-radius: 5px;">' +
                '<h3 style="color: #d32f2f; margin-top: 0;">Diagram Rendering Error</h3>' +
                '<p>' + message + '</p>' +
                '<p>This might be because:</p>' +
                '<ul>' +
                '<li>The diagram has too many components and relationships</li>' +
                '<li>The browser has limited resources</li>' +
                '<li>Try using the Component Relationship Explorer instead</li>' +
                '</ul>' +
                '</div>';
        }

        // Add diagram controls (zoom, pan)
        function addDiagramControls(container) {
            const svgElement = container.querySelector('svg');
            if (!svgElement) return;

            let zoom = 1;
            let pan = { x: 0, y: 0 };
            let isDragging = false;
            let startPoint = { x: 0, y: 0 };

            // Create controls container with improved positioning
            const controlsContainer = document.createElement('div');
            controlsContainer.className = 'diagram-controls';
            controlsContainer.style.position = 'absolute';
            controlsContainer.style.top = '10px';
            controlsContainer.style.right = '10px';
            controlsContainer.style.zIndex = '1000'; // Ensure controls are above the diagram
            controlsContainer.style.padding = '5px';
            controlsContainer.style.borderRadius = '4px';
            controlsContainer.style.backgroundColor = 'rgba(255, 255, 255, 0.9)';
            controlsContainer.style.boxShadow = '0 1px 3px rgba(0,0,0,0.2)';

            // Add zoom controls with improved styling
            const zoomInButton = document.createElement('button');
            zoomInButton.textContent = '+';
            zoomInButton.title = 'Zoom In';
            zoomInButton.style.padding = '3px 8px';
            zoomInButton.style.marginRight = '4px';

            const zoomOutButton = document.createElement('button');
            zoomOutButton.textContent = '-';
            zoomOutButton.title = 'Zoom Out';
            zoomOutButton.style.padding = '3px 8px';
            zoomOutButton.style.marginRight = '4px';

            const resetButton = document.createElement('button');
            resetButton.textContent = 'Reset';
            resetButton.title = 'Reset View';
            resetButton.style.padding = '3px 8px';

            controlsContainer.appendChild(zoomInButton);
            controlsContainer.appendChild(zoomOutButton);
            controlsContainer.appendChild(resetButton);

            // Add padding to the container to make room for controls
            container.style.paddingTop = '40px';
            container.style.position = 'relative';
            container.appendChild(controlsContainer);

            // Make SVG draggable for panning
            svgElement.style.cursor = 'grab';

            svgElement.addEventListener('mousedown', function(e) {
                if (e.button === 0) { // Left mouse button
                    isDragging = true;
                    startPoint = { x: e.clientX, y: e.clientY };
                    svgElement.style.cursor = 'grabbing';
                    e.preventDefault();
                }
            });

            document.addEventListener('mousemove', function(e) {
                if (isDragging) {
                    const dx = e.clientX - startPoint.x;
                    const dy = e.clientY - startPoint.y;

                    pan.x += dx;
                    pan.y += dy;

                    startPoint = { x: e.clientX, y: e.clientY };
                    updateTransform();
                }
            });

            document.addEventListener('mouseup', function() {
                isDragging = false;
                svgElement.style.cursor = 'grab';
            });

            // Add button functionality
            zoomInButton.addEventListener('click', function() {
                zoom = Math.min(zoom + 0.1, 3); // Cap zoom at 3x
                updateTransform();
            });

            zoomOutButton.addEventListener('click', function() {
                zoom = Math.max(zoom - 0.1, 0.3); // Minimum zoom of 0.3x
                updateTransform();
            });

            resetButton.addEventListener('click', function() {
                zoom = 1;
                pan = { x: 0, y: 0 };
                updateTransform();
            });

            // Update transform function
            function updateTransform() {
                svgElement.style.transform = `translate(${pan.x}px, ${pan.y}px) scale(${zoom})`;
                svgElement.style.transformOrigin = 'center';
            }
        }
    </script>
    
    <div style="margin-top: 30px; text-align: center;">
        <button id="exportSVG" class="button" style="margin-right: 10px;">Export Diagram as SVG</button>
        <button id="exportPNG" class="button" style="background-color: #2ecc71;">Export Diagram as PNG</button>
    </div>

    <script>
        document.getElementById('exportSVG').addEventListener('click', function() {
            // Find the active tab's diagram
            const activeTab = document.querySelector('.tab-content[style*="display: block"]');
            const svgElement = activeTab.querySelector('svg');
            if (!svgElement) {
                alert('No SVG diagram found to export');
                return;
            }

            // Create a copy of the SVG to manipulate for export
            const svgCopy = svgElement.cloneNode(true);
            const svgData = new XMLSerializer().serializeToString(svgCopy);
            const blob = new Blob([svgData], {type: 'image/svg+xml'});
            const url = URL.createObjectURL(blob);

            const a = document.createElement('a');
            a.href = url;
            a.download = 'ComplexProject_dependency_diagram.svg';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        });

        document.getElementById('exportPNG').addEventListener('click', function() {
            // Find the active tab's diagram
            const activeTab = document.querySelector('.tab-content[style*="display: block"]');
            const svgElement = activeTab.querySelector('svg');
            if (!svgElement) {
                alert('No SVG diagram found to export');
                return;
            }

            // Create a canvas and draw the SVG on it
            const canvas = document.createElement('canvas');
            const svgRect = svgElement.getBoundingClientRect();
            canvas.width = svgRect.width;
            canvas.height = svgRect.height;
            const ctx = canvas.getContext('2d');

            // Create an image from the SVG
            const img = new Image();
            const svgData = new XMLSerializer().serializeToString(svgElement);
            const svgBlob = new Blob([svgData], {type: 'image/svg+xml;charset=utf-8'});
            const url = URL.createObjectURL(svgBlob);

            img.onload = function() {
                ctx.drawImage(img, 0, 0);
                URL.revokeObjectURL(url);

                // Convert canvas to PNG
                try {
                    const pngUrl = canvas.toDataURL('image/png');
                    const a = document.createElement('a');
                    a.href = pngUrl;
                    a.download = 'ComplexProject_dependency_diagram.png';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                } catch(e) {
                    alert('Failed to export as PNG. This may be due to CORS restrictions with external SVG content.');
                    console.error(e);
                }
            };

            img.src = url;
        });
    </script>
    
    <footer>
        <p>Generated on 2025-05-21 12:29:15</p>
        <p>VB6 Project Mapper - A tool for analyzing Visual Basic 6.0 projects</p>
    </footer>
</body>
</html>
    